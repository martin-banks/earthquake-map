webpackJsonp([1],{"4eoe":function(e,t){},Gy93:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("W3Iv"),i=a.n(n),o=a("gRE1"),r=a.n(o),s=a("x4/c"),l=a.n(s),c=a("7+uW"),u=function(){return{nca:!!document.querySelector(".newscomau"),whimn:"www.whimn.com.au"===window.location.host||!!document.querySelector('[property="og:site_name"][content="whimn"]'),mhr:!!document.querySelector(".content .story"),longform:!!document.querySelector("[data-color-scheme]"),theme:document.querySelector('[data-color-scheme="dark"]')?"dark":"light",mobile:/iPad|Android|webOS|iPhone|iPod|Blackberry/.test(navigator.userAgent)&&!window.MSStream,isTestEnv:-1!==["localhost","127.0.0.1"].indexOf(window.location.hostname),isPreview:-1!==["media.news.com.au"].indexOf(window.location.hostname),h3o:!1}},d=a("peJn"),p=a.n(d),m=a("Gu7T"),v=a.n(m),f=a("nrd6"),h=a.n(f),g={name:"leaflet-data",props:[],components:{},data:function(){return{days:7,tileLayer:null,myMap:null,map:null,tile:{subdomains:"abcd",maxZoom:19,layer:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",attr:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'},coords:{center:[52,0],zoom:15},details:!1,responseData:null,dateRange:null,sliding:!1,slideTarget:null,bracket:{width:1,from:0,to:1},showControls:!1}},methods:{initMap:function(){var e=this.$root.content.map,t=e.coords,a=e.zoom;this.myMap=h.a.map(this.$el.querySelector("#map")).setView([t.lat,t.lng],a),this.tileLayer=h.a.tileLayer(this.tile.layer,{attribution:this.tile.attr}),this.tileLayer.addTo(this.myMap)},addMarkers:function(){var e=this;this.$root.content.markers.forEach(function(t){var a=t.coords,n=a.lat,i=a.lng,o=t.tooltip,r=t.type,s=t.size,l=t.popup,c=h.a[r]([n,i],{radius:s,color:"orange",fillColor:"rgb(220, 130, 0)",fillOpacity:.2,fill:!0,interactive:!1});c.addTo(e.myMap),o&&c.bindTooltip(""+o,{direction:"center",interactive:!0,permanent:!0}).openTooltip(),l&&c.addEventListener("click",function(){h.a.popup().setLatLng([n,i]).setContent(l).openOn(e.myMap)})})},addPopups:function(){var e=this;this.$root.content.popups.forEach(function(t){var a=t.coords,n=a.lat,i=a.lng;t.tooltip,t.type,t.size,h.a.popup().setLatLng([n,i]).setContent("Some popuyp content").openOn(e.myMap)})},mouseOverQuake:function(e){var t=arguments[0].data;this.details=t},renderQuakes:function(){var e=this;this.myMap.eachLayer(function(t){"circlemarker"===t.type&&e.myMap.removeLayer(t)}),this.markers=this.responseData.features.filter(function(t){if(!e.dateRange)return!0;var a=e.dateRange.from+e.bracket.from*e.dateRange.range,n=e.dateRange.from+e.dateRange.range*e.bracket.to;return t.properties.time>a&&t.properties.time<n}).map(function(t){var a=t.geometry.coordinates,n=h.a.circleMarker([a[1],a[0]],{radius:5*t.properties.mag,fillColor:"hsl("+(10-t.properties.mag)/10*50+", 100%, 50%)",fillOpacity:.2,color:"rgba(0,0,0,0)"});n.addTo(e.myMap),n.type="circlemarker",n.addEventListener("mouseover",e.mouseOverQuake.bind(!1,{data:t}));var i=h.a.circleMarker([a[1],a[0]+360],{radius:5*t.properties.mag,fillColor:"hsl("+(10-t.properties.mag)/10*50+", 100%, 50%)",fillOpacity:.2,color:"rgba(0,0,0,0)"});return i.addTo(e.myMap),i.type="circlemarker",i.addEventListener("mouseover",e.mouseOverQuake.bind(!1,{data:t})),{quake:n,quakeAlt:i}})},styles__timelineMark:function(e){var t=(e.time-this.dateRange.from+1)/this.dateRange.range*100;e.mag;return{left:t+"%"}},quakeDate:function(e){var t=new Date(e),a=t.getFullYear(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()];return t.getDate()+" "+n+" "+a},startTimelineScale:function(e){this.slideTarget=e,this.sliding=!0},endTimelineScale:function(e){this.sliding=!1,this.slideTarget=null,this.renderQuakes()},changeTimelineScale:function(e){if(this.sliding&&this.slideTarget){var t=this.$el.getBoundingClientRect().left,a=e.pageX;if("from"===this.slideTarget){var n=Math.max(0,(a-t)/this.$el.offsetWidth);this.bracket.from=n>this.bracket.to-.03?this.bracket.to-.03:n}else if("to"===this.slideTarget){var i=Math.min(1,(a-t)/this.$el.offsetWidth);this.bracket.to=i<this.bracket.from+.03?this.bracket.from+.03:i}this.bracket.width=1-this.bracket.from-(1-this.bracket.to)}},testfunc:function(){window.alert("you did something")}},computed:{style__bracket:function(){return{left:0,width:0}}},beforeMount:function(){},mounted:function(){var e=this,t=this.$root.content.markers;this.initMap(),t&&this.addMarkers();var a=new Date,n=new Date((new Date).setDate(a.getDate()-this.days)),i=("0"+(n.getMonth()+1)).slice(-2),o=("0"+n.getDate()).slice(-2),r=n.getFullYear(),s=("0"+(a.getMonth()+1)).slice(-2),l=("0"+a.getDate()).slice(-2),c=a.getFullYear();fetch("https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime="+(r+"-"+i+"-"+o)+"&endtime="+(c+"-"+s+"-"+l)).then(function(e){return e.json()}).then(function(t){e.responseData=t,e.renderQuakes();var a=t.features.map(function(e){return e.properties.time}),n=Math.min.apply(Math,v()(a)),i=Math.max.apply(Math,v()(a)),o=i-n;e.dateRange={from:n,to:i,range:o},e.showControls=!("ontouchstart"in document.documentElement)}).catch(console.error)}},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"map__wrapper"},[a("div",{attrs:{id:"map"}}),e._v(" "),e.details.properties?a("div",{staticClass:"quakeDetails"},[e.details.properties?a("h6",[e._v(e._s(e.details.properties.type))]):e._e(),e._v(" "),e.details.properties?a("h3",[e._v(e._s(e.details.properties.place))]):e._e(),e._v(" "),e.details.properties?a("p",[e._v(e._s(e.quakeDate(e.details.properties.time)))]):e._e(),e._v(" "),a("div",{staticClass:"magnitude__wrapper"},[a("p",[e._v("Magnitude: "+e._s(e.details.properties.mag))]),e._v(" "),a("div",{staticClass:"magnitude__track"},[a("div",{staticClass:"magnitude__mark",style:{left:e.details.properties.mag/10*100+"%"}})])]),e._v(" "),e.details.properties&&e.details.properties.tsunami?a("p",[e._v("\n        Tsunami warning issued\n      ")]):a("p",[e._v("\n        No tsunami warning\n      ")])]):e._e()]),e._v(" "),e.responseData?a("div",{staticClass:"timeline__wrapper"},[a("h4",[e._v("Timeline of quakes")]),e._v(" "),a("div",{staticClass:"timeline__track",on:{mousemove:e.changeTimelineScale}},[a("div",{staticClass:"timeline__mark--wrapper"},e._l(e.responseData.features,function(t,n){return a("div",{key:"timeline-"+n,staticClass:"timeline__mark",style:e.styles__timelineMark(t.properties)})})),e._v(" "),e.showControls?a("div",{staticClass:"timeline__controls--wrapper"},[a("div",{staticClass:"timeline__controls--bracket",style:{left:100*e.bracket.from+"%",width:100*e.bracket.width+"%"}}),e._v(" "),a("div",{staticClass:"timeline__slide timeline__slide--from",style:{left:100*e.bracket.from+"%"},attrs:{"data-scale":"from"},on:{mousedown:function(t){e.startTimelineScale("from")},mouseup:e.endTimelineScale}}),e._v(" "),a("div",{staticClass:"timeline__slide timeline__slide--to",style:{left:100*(e.bracket.width+e.bracket.from)+"%"},attrs:{"data-scale":"to"},on:{mousedown:function(t){e.startTimelineScale("to")},mouseup:e.endTimelineScale}})]):e._e()]),e._v(" "),a("div",{staticClass:"ticks__wrapper"},e._l(e.days+1,function(e){return a("div",{key:"tick-"+e,staticClass:"tick"})})),e._v(" "),a("div",{staticClass:"timeline__labels"},[a("p",[e._v(e._s(e.quakeDate(e.dateRange.from)))]),e._v(" "),a("p",[e._v(e._s(e.quakeDate(e.dateRange.to)))])])]):e._e()])};y._withStripped=!0;var _={render:y,staticRenderFns:[]},b=_;var w=!1;var k=a("VU/8")(g,b,!1,function(e){w||a("rxra")},null,null);k.options.__file="src/components/leaflet/leaflet-data.vue";var M={name:"demo-leaflet",props:[],components:{LeafletData:k.exports},data:function(){return{}},methods:{},computed:{}},T=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("leaflet-data")],1)};T._withStripped=!0;var C={render:T,staticRenderFns:[]},S=C;var q=!1;var D=a("VU/8")(M,S,!1,function(e){q||a("4eoe")},"data-v-165864b2",null);D.options.__file="src/layouts/demo-leaflet.vue";var E={layout:D.exports,showDump:!1,custom:{},header:{title:"Seven days of earth quakes",intro:!1},parts:[],map:{coords:{lat:35,lng:180},zoom:1.8},popups:[{type:"circleMarker",coords:{lat:51.3,lng:-2},size:20,tooltip:100}],markers:[]},O={name:"App",data:function(){return{project:p.a.name,about:{},content:E,version:"1.0."+(E.version||0)}},components:{UsedView:E.layout},beforeMount:function(){this.about=u()}},R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("article",{attrs:{"data-v":e.version,"data-project":e.project,"data-news":e.about.nca,"data-whimn":e.about.whimn,"data-mobile":e.about.mobile,"data-desktop":!e.about.mobile,"data-longform":e.about.longform,"data-theme":e.about.theme,"data-testenv":e.about.isTestEnv,"data-type":"dna-custom-app"}},[a("div",{staticClass:"dna-custom-app"},[e.content.showDump?a("pre",{staticClass:"dump"},[e._v("      "+e._s(JSON.stringify({project:e.project,about:e.about},"utf-8",2))+"\n    ")]):e._e(),e._v(" "),a("used-view")],1)])};R._withStripped=!0;var L={render:R,staticRenderFns:[]},A=L;var j=!1;var x=a("VU/8")(O,A,!1,function(e){j||a("Gy93")},null,null);x.options.__file="src/App.vue";var F=x.exports;var $={setup:function(e){var t,a,n,i,o,r;t=window,a=document,n="script",i="ga",t.GoogleAnalyticsObject=i,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,o=a.createElement(n),r=a.getElementsByTagName(n)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(o,r),ga("create",e,"auto"),ga("send","pageview")}},B={bind:function(e,t,a){var n=t.value;[].concat(v()(document.querySelectorAll('[data-brightcove="'+n+'"]'))).forEach(function(e){e.setAttribute("data-brightcove",null)}),e.innerHTML='<div data-brightcove="'+n+'"></div>',setTimeout(function(){window._vms=window._vms||[],window._vms.push({embedCode:n,target:'[data-brightcove="'+n+'"]',callback:function(){console.log("video "+n+" initalised")}})},0)}},N=a("E84t"),I=a.n(N);function z(e){e.style.transition="opacity 300ms",e.style.background="none",e.style.opacity=0,setTimeout(function(){e.parentNode.removeChild(e)},300)}var J={bind:function(e,t,a){e.style.opacity=0,e.style.transition="opacity 1s";var n=I()(e,{background:!0});n.on("fail",function(){var t=e.parentElement.querySelector("[data-spinner]");console.error("Image missing for:",e),t&&z(t)}),n.on("done",function(){var t=e.parentElement.querySelector("[data-spinner]");t&&z(t),e.style.opacity=1})}},V={bind:function(e,t,a){[].concat(v()(e.querySelectorAll("circle")))}},P=a("5N6T"),Q=a.n(P),G={inserted:function(e){Q()(e,{watch:!0})}},H=0,U=0,W=20,Y=0,X=80,Z=300;function K(){var e=this;setTimeout(function(){Y=e.el.getBoundingClientRect().top-X,U=Y/W,function e(){if(window.scrollBy(0,U),++H===W)return H=0,void(this.el.scrollIntoView&&(this.el.scrollIntoView(),window.scrollBy(0,0-X)));window.requestAnimationFrame(e.bind({el:this.el}))}.bind({el:e.el})()},Z)}var ee={update:function(e,t,a){t.value&&K.bind({el:e})()}},te={bind:function(e,t,a){window.addEventListener("scroll",function a(){var n=null;setTimeout(function(){e.getBoundingClientRect&&(n&&clearTimeout(n),n=setTimeout(function(){var n=e.getBoundingClientRect(),i=n.top;(i+.8*n.height<0||.8*i>window.innerHeight)&&(window.removeEventListener("scroll",a),t.value())},150))})})}},ae=u();console.log({client:ae}),E.analytics&&E.analytics.id&&$.setup(E.analytics.id);var ne=Function.bind.call(Function.call,Array.prototype.reduce),ie=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),oe=Function.bind.call(Function.call,Array.prototype.concat),re=l.a;r.a||(Object.values=function(e){return ne(re(e),function(t,a){return oe(t,"string"==typeof a&&ie(e,a)?[e[a]]:[])},[])}),i.a||(Object.entries=function(e){return ne(re(e),function(t,a){return oe(t,"string"==typeof a&&ie(e,a)?[[a,e[a]]]:[])},[])}),c.a.directive("imageloaded",J),c.a.directive("markerlabels",V),c.a.directive("balancetext",G),c.a.directive("scroll-to-top",ee),c.a.directive("scrolloutclose",te),c.a.directive("brightcove",B);var se=new c.a({el:"#app_"+p.a.name,components:{App:F},template:"<app/>",data:{client:ae,mobile:ae.mobile,custom:E.custom,content:E,videoSupported:!1}}),le=0,ce=null;ce=setInterval(function(){le++,window.videojs&&(clearInterval(ce),se.videoSupported=!0),le>10&&clearInterval(le)},1e3)},peJn:function(e,t){e.exports={name:"earthquake-map"}},rxra:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.js.map