webpackJsonp([1],{DRXA:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("W3Iv"),i=a.n(n),o=a("gRE1"),r=a.n(o),s=a("x4/c"),l=a.n(s),c=a("7+uW"),u=function(){return{nca:!!document.querySelector(".newscomau"),whimn:"www.whimn.com.au"===window.location.host||!!document.querySelector('[property="og:site_name"][content="whimn"]'),mhr:!!document.querySelector(".content .story"),longform:!!document.querySelector("[data-color-scheme]"),theme:document.querySelector('[data-color-scheme="dark"]')?"dark":"light",mobile:/iPad|Android|webOS|iPhone|iPod|Blackberry/.test(navigator.userAgent)&&!window.MSStream,isTestEnv:-1!==["localhost","127.0.0.1"].indexOf(window.location.hostname),isPreview:-1!==["media.news.com.au"].indexOf(window.location.hostname),h3o:!1}},m=a("peJn"),d=a.n(m),p=a("Gu7T"),f=a.n(p),h=a("nrd6"),v=a.n(h),g={name:"leaflet-data",props:[],components:{},data:function(){return{days:7,tileLayer:null,myMap:null,map:null,tile:{subdomains:"abcd",attr:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'},details:!1,responseData:null,dates:{from:0,to:0},dateRange:null,timelineRange:{from:0,to:0},sliding:!1,slideTarget:null,bracket:{width:1,from:0,to:1},showControls:!1}},methods:{initMap:function(){var e=this.$root.content.map,t=e.coords,a=e.zoom,n=e.minZoom,i=e.maxZoom;this.myMap=v.a.map(this.$el.querySelector("#map")).setView([t.lat,t.lng],a),this.myMap.options.minZoom=n,this.myMap.options.maxZoom=i,this.tileLayer=v.a.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/"+this.theme+"_all/{z}/{x}/{y}{r}.png",{attribution:this.tile.attr}),this.tileLayer.addTo(this.myMap)},addMarkers:function(){var e=this;this.$root.content.markers.forEach(function(t){var a=t.coords,n=a.lat,i=a.lng,o=t.tooltip,r=t.type,s=t.size,l=t.popup,c=v.a[r]([n,i],{radius:s,color:"orange",fillColor:"rgb(220, 130, 0)",fillOpacity:.2,fill:!0,interactive:!1});c.addTo(e.myMap),o&&c.bindTooltip(""+o,{direction:"center",interactive:!0,permanent:!0}).openTooltip(),l&&c.addEventListener("click",function(){v.a.popup().setLatLng([n,i]).setContent(l).openOn(e.myMap)})})},addPopups:function(){var e=this;this.$root.content.popups.forEach(function(t){var a=t.coords,n=a.lat,i=a.lng;t.tooltip,t.type,t.size,v.a.popup().setLatLng([n,i]).setContent("Some popuyp content").openOn(e.myMap)})},mouseOverQuake:function(e){var t=arguments[0].data;this.details=t},renderQuakes:function(){var e=this;this.myMap.eachLayer(function(t){"circlemarker"===t.type&&e.myMap.removeLayer(t)}),this.markers=this.responseData.features.filter(function(t){if(!e.dateRange)return!0;var a=e.dateRange.from+e.bracket.from*e.dateRange.range,n=e.dateRange.from+e.dateRange.range*e.bracket.to;return t.properties.time>a&&t.properties.time<n}).map(function(t){var a=t.geometry.coordinates,n=v.a.circleMarker([a[1],a[0]],{radius:5*t.properties.mag,fillColor:"hsl("+(10-t.properties.mag)/10*50+", 100%, 50%)",fillOpacity:.2,color:"rgba(0,0,0,0)"});n.addTo(e.myMap),n.type="circlemarker",n.addEventListener("mouseover",e.mouseOverQuake.bind(!1,{data:t}));var i=v.a.circleMarker([a[1],a[0]+360],{radius:5*t.properties.mag,fillColor:"hsl("+(10-t.properties.mag)/10*50+", 100%, 50%)",fillOpacity:.2,color:"rgba(0,0,0,0)"});return i.addTo(e.myMap),i.type="circlemarker",i.addEventListener("mouseover",e.mouseOverQuake.bind(!1,{data:t})),{quake:n,quakeAlt:i}})},styles__timelineMark:function(e){var t=(e.time-this.dateRange.from+1)/this.dateRange.range*100;e.mag;return{left:t+"%"}},quakeDate:function(e){var t=new Date(e),a=t.getFullYear(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],i=t.getDate(),o=t.getHours(),r=("0"+t.getMinutes()).slice(-2);return i+" "+n+" "+a+", "+(o>12?o-12:o)+":"+r+" "+(o>=12?"pm":"am")},startTimelineScale:function(e){this.slideTarget=e,this.sliding=!0},endTimelineScale:function(e){this.sliding=!1,this.slideTarget=null,this.renderQuakes()},changeTimelineScale:function(e){if(this.sliding&&this.slideTarget){var t=e.pageX;if("from"===this.slideTarget){var a=Math.max(0,(t-32)/(this.$el.offsetWidth-64));this.bracket.from=a>this.bracket.to-.03?this.bracket.to-.03:a,this.timelineRange.from=this.dates.from+this.bracket.from*this.dateRange.range}else if("to"===this.slideTarget){var n=Math.min(1,(t-32)/(this.$el.offsetWidth-64));this.bracket.to=n<this.bracket.from+.03?this.bracket.from+.03:n,this.timelineRange.to=this.dates.from+this.dateRange.range*this.bracket.to}this.bracket.width=1-this.bracket.from-(1-this.bracket.to)}},testfunc:function(){window.alert("you did something")}},computed:{style__bracket:function(){return{left:0,width:0}},theme:function(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}},beforeMount:function(){},mounted:function(){var e=this,t=this.$root.content.markers;this.initMap(),t&&this.addMarkers();var a=new Date((new Date).setHours(0,0,0,0)),n=new Date((new Date).setDate(a.getDate()-this.days));console.log({firstDay:n,today:a});var i=("0"+(n.getMonth()+1)).slice(-2),o=("0"+n.getDate()).slice(-2),r=n.getFullYear(),s=("0"+(a.getMonth()+1)).slice(-2),l=("0"+a.getDate()).slice(-2),c="https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime="+(r+"-"+i+"-"+o)+"&endtime="+(a.getFullYear()+"-"+s+"-"+l);console.log(c),fetch(c).then(function(e){return e.json()}).then(function(t){e.responseData=t,console.log("number of quakes",t.features.length),e.renderQuakes();var a=t.features.filter(function(e){return e.properties.felt}),n=t.features.filter(function(e){return e.properties.tsunami});console.log({felt:a,tsunami:n});var i=t.features.map(function(e){return e.properties.time}),o=Math.min.apply(Math,f()(i)),r=Math.max.apply(Math,f()(i)),s=r-o;e.dates={from:o,to:r},e.dateRange={from:o,to:r,range:s},e.timelineRange={from:new Date(new Date(o).setHours(0,0,0,0)),to:new Date(r+1).setHours(0,0,0,0)},e.showControls=!("ontouchstart"in document.documentElement)}).catch(console.error)}},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._m(0),e._v(" "),e.responseData?a("div",{staticClass:"timeline__wrapper"},[e.details.properties?a("div",{staticClass:"quakeDetails"},[a("div",{staticClass:"quakeDetails__content"},[e.details.properties?a("h6",[e._v(e._s(e.details.properties.type))]):e._e(),e._v(" "),e.details.properties?a("h3",[e._v(e._s(e.details.properties.place))]):e._e(),e._v(" "),e.details.properties?a("p",[e._v(e._s(e.quakeDate(e.details.properties.time)))]):e._e(),e._v(" "),a("div",{staticClass:"magnitude__wrapper"},[a("p",[e._v("Magnitude: "+e._s(e.details.properties.mag))])]),e._v(" "),a("div",{staticClass:"magnitude__track"},[a("div",{staticClass:"magnitude__mark",style:{left:e.details.properties.mag/10*100+"%"}})]),e._v(" "),e.details.properties&&e.details.properties.tsunami?a("p",[e._v("Tsunami warning issued")]):a("p",[e._v("No tsunami warning")])])]):e._e(),e._v(" "),a("h4",{staticClass:"timeline__title"},[e._v("Timeline of quakes")]),e._v(" "),a("div",{staticClass:"timeline__labels"},[a("p",{style:{left:100*e.bracket.from+"%"}},[e._v(e._s(e.quakeDate(e.timelineRange.from)))])]),e._v(" "),a("div",{staticClass:"timeline__track",on:{mousemove:e.changeTimelineScale}},[a("div",{staticClass:"timeline__mark--wrapper"},e._l(e.responseData.features,function(t,n){return a("div",{key:"timeline-"+n,staticClass:"timeline__mark",style:e.styles__timelineMark(t.properties)})})),e._v(" "),e.showControls?a("div",{staticClass:"timeline__controls--wrapper"},[a("div",{staticClass:"timeline__controls--bracket",style:{left:100*e.bracket.from+"%",width:100*e.bracket.width+"%"}}),e._v(" "),a("div",{staticClass:"timeline__slide timeline__slide--from",style:{left:100*e.bracket.from+"%"},attrs:{"data-scale":"from"},on:{mousedown:function(t){e.startTimelineScale("from")},mouseup:e.endTimelineScale}}),e._v(" "),a("div",{staticClass:"timeline__slide timeline__slide--to",style:{left:100*(e.bracket.width+e.bracket.from)+"%"},attrs:{"data-scale":"to"},on:{mousedown:function(t){e.startTimelineScale("to")},mouseup:e.endTimelineScale}})]):e._e()]),e._v(" "),a("div",{staticClass:"timeline__labels"},[a("p",{staticClass:"timeline__labels--right",style:{left:100*e.bracket.to+"%"}},[e._v("\n        "+e._s(e.quakeDate(e.timelineRange.to))+"\n      ")])])]):e._e()])};y._withStripped=!0;var _={render:y,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"map__wrapper"},[t("div",{attrs:{id:"map"}})])}]},b=_;var w=!1;var k=a("VU/8")(g,b,!1,function(e){w||a("DRXA")},null,null);k.options.__file="src/components/leaflet/leaflet-data.vue";var M={name:"demo-leaflet",props:[],components:{LeafletData:k.exports},data:function(){return{}},methods:{},computed:{}},C=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("leaflet-data")],1)};C._withStripped=!0;var D={render:C,staticRenderFns:[]},T=D;var S=!1;var q=a("VU/8")(M,T,!1,function(e){S||a("tfKr")},"data-v-165864b2",null);q.options.__file="src/layouts/demo-leaflet.vue";var R={layout:q.exports,showDump:!1,custom:{},header:{title:"Seven days of earthquakes",intro:!1},parts:[],map:{coords:{lat:15,lng:180},zoom:3,maxZoom:10,minZoom:3},popups:[{type:"circleMarker",coords:{lat:51.3,lng:-2},size:20,tooltip:100}],markers:[]},E={name:"App",data:function(){return{project:d.a.name,about:{},content:R,version:"1.0."+(R.version||0)}},components:{UsedView:R.layout},beforeMount:function(){this.about=u()}},O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("article",{attrs:{"data-v":e.version,"data-project":e.project,"data-news":e.about.nca,"data-whimn":e.about.whimn,"data-mobile":e.about.mobile,"data-desktop":!e.about.mobile,"data-longform":e.about.longform,"data-theme":e.about.theme,"data-testenv":e.about.isTestEnv,"data-type":"dna-custom-app"}},[a("div",{staticClass:"dna-custom-app"},[e.content.showDump?a("pre",{staticClass:"dump"},[e._v("      "+e._s(JSON.stringify({project:e.project,about:e.about},"utf-8",2))+"\n    ")]):e._e(),e._v(" "),a("used-view")],1)])};O._withStripped=!0;var L={render:O,staticRenderFns:[]},A=L;var x=!1;var F=a("VU/8")(E,A,!1,function(e){x||a("dNtk")},null,null);F.options.__file="src/App.vue";var j=F.exports;var N={setup:function(e){var t,a,n,i,o,r;t=window,a=document,n="script",i="ga",t.GoogleAnalyticsObject=i,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,o=a.createElement(n),r=a.getElementsByTagName(n)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(o,r),ga("create",e,"auto"),ga("send","pageview")}},$=a("E84t"),B=a.n($);function H(e){e.style.transition="opacity 300ms",e.style.background="none",e.style.opacity=0,setTimeout(function(){e.parentNode.removeChild(e)},300)}var J={bind:function(e,t,a){e.style.opacity=0,e.style.transition="opacity 1s";var n=B()(e,{background:!0});n.on("fail",function(){var t=e.parentElement.querySelector("[data-spinner]");console.error("Image missing for:",e),t&&H(t)}),n.on("done",function(){var t=e.parentElement.querySelector("[data-spinner]");t&&H(t),e.style.opacity=1})}},V={bind:function(e,t,a){[].concat(f()(e.querySelectorAll("circle")))}},z=a("5N6T"),P=a.n(z),Q={inserted:function(e){P()(e,{watch:!0})}},Z=0,I=0,U=20,W=0,X=80,Y=300;function G(){var e=this;setTimeout(function(){W=e.el.getBoundingClientRect().top-X,I=W/U,function e(){if(window.scrollBy(0,I),++Z===U)return Z=0,void(this.el.scrollIntoView&&(this.el.scrollIntoView(),window.scrollBy(0,0-X)));window.requestAnimationFrame(e.bind({el:this.el}))}.bind({el:e.el})()},Y)}var K={update:function(e,t,a){t.value&&G.bind({el:e})()}},ee={bind:function(e,t,a){window.addEventListener("scroll",function a(){var n=null;setTimeout(function(){e.getBoundingClientRect&&(n&&clearTimeout(n),n=setTimeout(function(){var n=e.getBoundingClientRect(),i=n.top;(i+.8*n.height<0||.8*i>window.innerHeight)&&(window.removeEventListener("scroll",a),t.value())},150))})})}},te=u();console.log({client:te}),R.analytics&&R.analytics.id&&N.setup(R.analytics.id);var ae=Function.bind.call(Function.call,Array.prototype.reduce),ne=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),ie=Function.bind.call(Function.call,Array.prototype.concat),oe=l.a;r.a||(Object.values=function(e){return ae(oe(e),function(t,a){return ie(t,"string"==typeof a&&ne(e,a)?[e[a]]:[])},[])}),i.a||(Object.entries=function(e){return ae(oe(e),function(t,a){return ie(t,"string"==typeof a&&ne(e,a)?[[a,e[a]]]:[])},[])}),c.a.directive("imageloaded",J),c.a.directive("markerlabels",V),c.a.directive("balancetext",Q),c.a.directive("scroll-to-top",K),c.a.directive("scrolloutclose",ee);new c.a({el:"#app_"+d.a.name,components:{App:j},template:"<app/>",data:{client:te,mobile:te.mobile,custom:R.custom,content:R}})},dNtk:function(e,t){},peJn:function(e,t){e.exports={name:"earthquake-map"}},tfKr:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.js.map