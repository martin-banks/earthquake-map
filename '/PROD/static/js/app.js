webpackJsonp([1],{DRXA:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("W3Iv"),i=a.n(n),r=a("gRE1"),o=a.n(r),s=a("x4/c"),l=a.n(s),c=a("7+uW"),u=function(){return{nca:!!document.querySelector(".newscomau"),whimn:"www.whimn.com.au"===window.location.host||!!document.querySelector('[property="og:site_name"][content="whimn"]'),mhr:!!document.querySelector(".content .story"),longform:!!document.querySelector("[data-color-scheme]"),theme:document.querySelector('[data-color-scheme="dark"]')?"dark":"light",mobile:/iPad|Android|webOS|iPhone|iPod|Blackberry/.test(navigator.userAgent)&&!window.MSStream,isTestEnv:-1!==["localhost","127.0.0.1"].indexOf(window.location.hostname),isPreview:-1!==["media.news.com.au"].indexOf(window.location.hostname),h3o:!1}},d=a("peJn"),p=a.n(d),m=a("Gu7T"),f=a.n(m),v=a("nrd6"),h=a.n(v),g={name:"leaflet-data",props:[],components:{},data:function(){return{days:7,tileLayer:null,myMap:null,map:null,tile:{subdomains:"abcd",maxZoom:19,layer:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",attr:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'},coords:{center:[52,0],zoom:15},details:!1,responseData:null,dateRange:null,sliding:!1,slideTarget:null,bracket:{width:1,from:0,to:1},showControls:!1}},methods:{initMap:function(){var e=this.$root.content.map,t=e.coords,a=e.zoom;this.myMap=h.a.map(this.$el.querySelector("#map")).setView([t.lat,t.lng],a),this.tileLayer=h.a.tileLayer(this.tile.layer,{attribution:this.tile.attr}),this.tileLayer.addTo(this.myMap)},addMarkers:function(){var e=this;this.$root.content.markers.forEach(function(t){var a=t.coords,n=a.lat,i=a.lng,r=t.tooltip,o=t.type,s=t.size,l=t.popup,c=h.a[o]([n,i],{radius:s,color:"orange",fillColor:"rgb(220, 130, 0)",fillOpacity:.2,fill:!0,interactive:!1});c.addTo(e.myMap),r&&c.bindTooltip(""+r,{direction:"center",interactive:!0,permanent:!0}).openTooltip(),l&&c.addEventListener("click",function(){h.a.popup().setLatLng([n,i]).setContent(l).openOn(e.myMap)})})},addPopups:function(){var e=this;this.$root.content.popups.forEach(function(t){var a=t.coords,n=a.lat,i=a.lng;t.tooltip,t.type,t.size,h.a.popup().setLatLng([n,i]).setContent("Some popuyp content").openOn(e.myMap)})},mouseOverQuake:function(e){var t=arguments[0].data;this.details=t},renderQuakes:function(){var e=this;this.myMap.eachLayer(function(t){"circlemarker"===t.type&&e.myMap.removeLayer(t)}),this.markers=this.responseData.features.filter(function(t){if(!e.dateRange)return!0;var a=e.dateRange.from+e.bracket.from*e.dateRange.range,n=e.dateRange.from+e.dateRange.range*e.bracket.to;return t.properties.time>a&&t.properties.time<n}).map(function(t){var a=t.geometry.coordinates,n=h.a.circleMarker([a[1],a[0]],{radius:5*t.properties.mag,fillColor:"hsl("+(10-t.properties.mag)/10*50+", 100%, 50%)",fillOpacity:.2,color:"rgba(0,0,0,0)"});n.addTo(e.myMap),n.type="circlemarker",n.addEventListener("mouseover",e.mouseOverQuake.bind(!1,{data:t}));var i=h.a.circleMarker([a[1],a[0]+360],{radius:5*t.properties.mag,fillColor:"hsl("+(10-t.properties.mag)/10*50+", 100%, 50%)",fillOpacity:.2,color:"rgba(0,0,0,0)"});return i.addTo(e.myMap),i.type="circlemarker",i.addEventListener("mouseover",e.mouseOverQuake.bind(!1,{data:t})),{quake:n,quakeAlt:i}})},styles__timelineMark:function(e){var t=(e.time-this.dateRange.from+1)/this.dateRange.range*100;e.mag;return{left:t+"%"}},quakeDate:function(e){var t=new Date(e),a=t.getFullYear(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()];return t.getDate()+" "+n+" "+a},startTimelineScale:function(e){this.slideTarget=e,this.sliding=!0},endTimelineScale:function(e){this.sliding=!1,this.slideTarget=null,this.renderQuakes()},changeTimelineScale:function(e){if(this.sliding&&this.slideTarget){var t=this.$el.getBoundingClientRect().left,a=e.pageX;if("from"===this.slideTarget){var n=Math.max(0,(a-t)/this.$el.offsetWidth);this.bracket.from=n>this.bracket.to-.03?this.bracket.to-.03:n}else if("to"===this.slideTarget){var i=Math.min(1,(a-t)/this.$el.offsetWidth);this.bracket.to=i<this.bracket.from+.03?this.bracket.from+.03:i}this.bracket.width=1-this.bracket.from-(1-this.bracket.to)}},testfunc:function(){window.alert("you did something")}},computed:{style__bracket:function(){return{left:0,width:0}}},beforeMount:function(){},mounted:function(){var e=this,t=this.$root.content.markers;this.initMap(),t&&this.addMarkers();var a=new Date,n=new Date((new Date).setDate(a.getDate()-this.days)),i=("0"+(n.getMonth()+1)).slice(-2),r=("0"+n.getDate()).slice(-2),o=n.getFullYear(),s=("0"+(a.getMonth()+1)).slice(-2),l=("0"+a.getDate()).slice(-2),c=a.getFullYear();fetch("https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime="+(o+"-"+i+"-"+r)+"&endtime="+(c+"-"+s+"-"+l)).then(function(e){return e.json()}).then(function(t){e.responseData=t,e.renderQuakes();var a=t.features.map(function(e){return e.properties.time}),n=Math.min.apply(Math,f()(a)),i=Math.max.apply(Math,f()(a)),r=i-n;e.dateRange={from:n,to:i,range:r},e.showControls=!("ontouchstart"in document.documentElement)}).catch(console.error)}},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"map__wrapper"},[a("div",{attrs:{id:"map"}}),e._v(" "),e.details.properties?a("div",{staticClass:"quakeDetails"},[e.details.properties?a("h6",[e._v(e._s(e.details.properties.type))]):e._e(),e._v(" "),e.details.properties?a("h3",[e._v(e._s(e.details.properties.place))]):e._e(),e._v(" "),e.details.properties?a("p",[e._v(e._s(e.quakeDate(e.details.properties.time)))]):e._e(),e._v(" "),a("div",{staticClass:"magnitude__wrapper"},[a("p",[e._v("Magnitude: "+e._s(e.details.properties.mag))]),e._v(" "),a("div",{staticClass:"magnitude__track"},[a("div",{staticClass:"magnitude__mark",style:{left:e.details.properties.mag/10*100+"%"}})])]),e._v(" "),e.details.properties&&e.details.properties.tsunami?a("p",[e._v("\n        Tsunami warning issued\n      ")]):a("p",[e._v("\n        No tsunami warning\n      ")])]):e._e()]),e._v(" "),e.responseData?a("div",{staticClass:"timeline__wrapper"},[a("h4",[e._v("Timeline of quakes")]),e._v(" "),a("div",{staticClass:"timeline__track",on:{mousemove:e.changeTimelineScale}},[a("div",{staticClass:"timeline__mark--wrapper"},e._l(e.responseData.features,function(t,n){return a("div",{key:"timeline-"+n,staticClass:"timeline__mark",style:e.styles__timelineMark(t.properties)})})),e._v(" "),e.showControls?a("div",{staticClass:"timeline__controls--wrapper"},[a("div",{staticClass:"timeline__controls--bracket",style:{left:100*e.bracket.from+"%",width:100*e.bracket.width+"%"}}),e._v(" "),a("div",{staticClass:"timeline__slide timeline__slide--from",style:{left:100*e.bracket.from+"%"},attrs:{"data-scale":"from"},on:{mousedown:function(t){e.startTimelineScale("from")},mouseup:e.endTimelineScale}}),e._v(" "),a("div",{staticClass:"timeline__slide timeline__slide--to",style:{left:100*(e.bracket.width+e.bracket.from)+"%"},attrs:{"data-scale":"to"},on:{mousedown:function(t){e.startTimelineScale("to")},mouseup:e.endTimelineScale}})]):e._e()]),e._v(" "),a("div",{staticClass:"ticks__wrapper"},e._l(e.days+1,function(e){return a("div",{key:"tick-"+e,staticClass:"tick"})})),e._v(" "),a("div",{staticClass:"timeline__labels"},[a("p",[e._v(e._s(e.quakeDate(e.dateRange.from)))]),e._v(" "),a("p",[e._v(e._s(e.quakeDate(e.dateRange.to)))])])]):e._e()])};y._withStripped=!0;var _={render:y,staticRenderFns:[]},w=_;var b=!1;var k=a("VU/8")(g,w,!1,function(e){b||a("DRXA")},null,null);k.options.__file="src/components/leaflet/leaflet-data.vue";var M={name:"demo-leaflet",props:[],components:{LeafletData:k.exports},data:function(){return{}},methods:{},computed:{}},C=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("leaflet-data")],1)};C._withStripped=!0;var T={render:C,staticRenderFns:[]},S=T;var D=!1;var q=a("VU/8")(M,S,!1,function(e){D||a("tfKr")},"data-v-165864b2",null);q.options.__file="src/layouts/demo-leaflet.vue";var R={layout:q.exports,showDump:!1,custom:{},header:{title:"Seven days of earth quakes",intro:!1},parts:[],map:{coords:{lat:35,lng:180},zoom:1.8},popups:[{type:"circleMarker",coords:{lat:51.3,lng:-2},size:20,tooltip:100}],markers:[]},E={name:"App",data:function(){return{project:p.a.name,about:{},content:R,version:"1.0."+(R.version||0)}},components:{UsedView:R.layout},beforeMount:function(){this.about=u()}},O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("article",{attrs:{"data-v":e.version,"data-project":e.project,"data-news":e.about.nca,"data-whimn":e.about.whimn,"data-mobile":e.about.mobile,"data-desktop":!e.about.mobile,"data-longform":e.about.longform,"data-theme":e.about.theme,"data-testenv":e.about.isTestEnv,"data-type":"dna-custom-app"}},[a("div",{staticClass:"dna-custom-app"},[e.content.showDump?a("pre",{staticClass:"dump"},[e._v("      "+e._s(JSON.stringify({project:e.project,about:e.about},"utf-8",2))+"\n    ")]):e._e(),e._v(" "),a("used-view")],1)])};O._withStripped=!0;var L={render:O,staticRenderFns:[]},A=L;var F=!1;var j=a("VU/8")(E,A,!1,function(e){F||a("dNtk")},null,null);j.options.__file="src/App.vue";var x=j.exports;var N={setup:function(e){var t,a,n,i,r,o;t=window,a=document,n="script",i="ga",t.GoogleAnalyticsObject=i,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,r=a.createElement(n),o=a.getElementsByTagName(n)[0],r.async=1,r.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(r,o),ga("create",e,"auto"),ga("send","pageview")}},$=a("E84t"),B=a.n($);function z(e){e.style.transition="opacity 300ms",e.style.background="none",e.style.opacity=0,setTimeout(function(){e.parentNode.removeChild(e)},300)}var J={bind:function(e,t,a){e.style.opacity=0,e.style.transition="opacity 1s";var n=B()(e,{background:!0});n.on("fail",function(){var t=e.parentElement.querySelector("[data-spinner]");console.error("Image missing for:",e),t&&z(t)}),n.on("done",function(){var t=e.parentElement.querySelector("[data-spinner]");t&&z(t),e.style.opacity=1})}},V={bind:function(e,t,a){[].concat(f()(e.querySelectorAll("circle")))}},P=a("5N6T"),Q=a.n(P),I={inserted:function(e){Q()(e,{watch:!0})}},U=0,W=0,H=20,X=0,Y=80,G=300;function K(){var e=this;setTimeout(function(){X=e.el.getBoundingClientRect().top-Y,W=X/H,function e(){if(window.scrollBy(0,W),++U===H)return U=0,void(this.el.scrollIntoView&&(this.el.scrollIntoView(),window.scrollBy(0,0-Y)));window.requestAnimationFrame(e.bind({el:this.el}))}.bind({el:e.el})()},G)}var Z={update:function(e,t,a){t.value&&K.bind({el:e})()}},ee={bind:function(e,t,a){window.addEventListener("scroll",function a(){var n=null;setTimeout(function(){e.getBoundingClientRect&&(n&&clearTimeout(n),n=setTimeout(function(){var n=e.getBoundingClientRect(),i=n.top;(i+.8*n.height<0||.8*i>window.innerHeight)&&(window.removeEventListener("scroll",a),t.value())},150))})})}},te=u();console.log({client:te}),R.analytics&&R.analytics.id&&N.setup(R.analytics.id);var ae=Function.bind.call(Function.call,Array.prototype.reduce),ne=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),ie=Function.bind.call(Function.call,Array.prototype.concat),re=l.a;o.a||(Object.values=function(e){return ae(re(e),function(t,a){return ie(t,"string"==typeof a&&ne(e,a)?[e[a]]:[])},[])}),i.a||(Object.entries=function(e){return ae(re(e),function(t,a){return ie(t,"string"==typeof a&&ne(e,a)?[[a,e[a]]]:[])},[])}),c.a.directive("imageloaded",J),c.a.directive("markerlabels",V),c.a.directive("balancetext",I),c.a.directive("scroll-to-top",Z),c.a.directive("scrolloutclose",ee);new c.a({el:"#app_"+p.a.name,components:{App:x},template:"<app/>",data:{client:te,mobile:te.mobile,custom:R.custom,content:R}})},dNtk:function(e,t){},peJn:function(e,t){e.exports={name:"earthquake-map"}},tfKr:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.js.map